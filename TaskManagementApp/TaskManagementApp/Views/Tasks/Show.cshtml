@model TaskManagementApp.Models.Task

@{
    ViewData["Title"] = Model.Title;
}



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />

<div class="container mt-5">
    <div class="card shadow-sm p-4 rounded-4">

        <h2 class="mb-3">@Model.Title</h2>

        <span class="badge bg-info">@Model.Status</span>

        <p class="mt-3"><strong>Descriere:</strong> @Model.Description</p>

        @if (!string.IsNullOrEmpty(Model.Content))
        {
            <p><strong>Conținut:</strong> @Model.Content</p>
        }

        <p>
            <strong>Start:</strong> @Model.StartDate.ToString("dd/MM/yyyy") <br />
            <strong>Final:</strong> @Model.EndDate.ToString("dd/MM/yyyy")
        </p>

        <p>
            <strong>Asignat către:</strong>
            @if (Model.User != null)
            {
                @Model.User.UserName
            }
            else
            {
                <span class="text-muted">Neasignat</span>
            }
        </p>

        <div class="mt-3">
            @if (ViewBag.EsteOrganizator == true || ViewBag.EsteAdmin == true || ViewBag.EsteMembru == true)
            {
                <a asp-controller="Tasks"
                   asp-action="Edit"
                   asp-route-id="@Model.Id"
                   class="btn btn-outline-warning rounded-pill me-2">
                    ✏ Editează
                </a>

                <form asp-controller="Tasks"
                      asp-action="Delete"
                      asp-route-id="@Model.Id"
                      method="post"
                      class="d-inline">
                    <button class="btn btn-outline-danger rounded-pill"
                            onclick="return confirm('Ștergi acest task?')">
                        🗑 Șterge
                    </button>
                </form>
            }
        </div>

        <hr class="my-4" />

        <h4>Comentarii</h4>

        @await Html.PartialAsync("_CommentListPartial", Model.Comments)

        @if (ViewBag.EsteMembru || ViewBag.EsteOrganizator || ViewBag.EsteAdmin)
        {
            <form asp-controller="Comments" asp-action="New" method="post" class="mt-3">
                <input type="hidden" name="taskId" value="@Model.Id" />

                <div class="mb-3">
                    <textarea name="Text" class="form-control" placeholder="Scrie un comentariu..." required></textarea>
                </div>

                <button class="btn btn-primary rounded-pill">
                    Adaugă comentariu
                </button>
            </form>

        }

    </div>
</div>
