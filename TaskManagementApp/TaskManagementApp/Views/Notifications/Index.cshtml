@model IEnumerable<TaskManagementApp.Models.Notification>

<div class="container mt-5">
    <h2><i class="bi bi-inbox"></i>My Inbox</h2>
    <hr />

    <div class="list-group">
        @foreach (var notif in Model)
        {
            <div class="list-group-item list-group-item-action @(notif.IsRead ? "bg-light" : "border-primary")">
                <div class="d-flex w-100 justify-content-between">
                    <h5 class="mb-1">
                        @if (notif.Type == "Invite")
                        {
                            <span class="badge bg-success">Project Invitation</span>
                        }
                        else
                        {

                            <span class="badge bg-info">Comment</span>
                        }
                    </h5>
                    <small>@notif.CreatedDate.ToString("g")</small>
                </div>

                <p class="mb-1">
                    <strong>@(notif.Sender?.UserName ?? "Sistem")</strong>: @notif.Text
                </p>

                <div class="mt-2">
                    @if (notif.Type == "Invite")
                    {
                        <form asp-action="AcceptInvite" method="post">
                            <input type="hidden" name="notificationId" value="@notif.Id" />
                            <input type="hidden" name="projectId" value="@notif.RelatedEntityId" />
                            <button type="submit" class="btn btn-sm btn-success">✅ Accept and join the project</button>
                        </form>
                    }
                    else if (notif.Type == "Comment")
                    {
                        <form asp-action="MarkRead" class="d-inline" method="post">
                            <input type="hidden" name="id" value="@notif.Id" />
                            <a href="@notif.Link" class="btn btn-sm btn-primary">View Task</a>
                            <button type="submit" class="btn btn-sm btn-outline-secondary">Mark as read</button>
                        </form>
                    }
                </div>
            </div>
        }

        @if (!Model.Any())
        {
            <div class="alert alert-secondary text-center">Best news are no news!</div>
        }
    </div>
</div>